$(function(){$.fn.actions=function(e){var t=$.extend({},$.fn.actions.defaults,e);var n=$(this);var r=false;var i=function(e){if(e){o()}else{a()}$(n).prop("checked",e).parent().parent().toggleClass(t.selectedClass,e)},s=function(){var e=$(n).filter(":checked").length;$(t.counterContainer).html(interpolate(ngettext("%(sel)s of %(cnt)s selected","%(sel)s of %(cnt)s selected",e),{sel:e,cnt:_actions_icnt},true));$(t.allToggle).prop("checked",function(){if(e==n.length){value=true;o()}else{value=false;f()}return value})},o=function(){$(t.acrossClears).hide();$(t.acrossQuestions).show();$(t.allContainer).hide()},u=function(){$(t.acrossClears).show();$(t.acrossQuestions).hide();$(t.actionContainer).toggleClass(t.selectedClass);$(t.allContainer).show();$(t.counterContainer).hide()},a=function(){$(t.acrossClears).hide();$(t.acrossQuestions).hide();$(t.allContainer).hide();$(t.counterContainer).show()},f=function(){a();$(t.acrossInput).val(0);$(t.actionContainer).removeClass(t.selectedClass)};$(t.counterContainer).show();$(this).filter(":checked").each(function(e){$(this).parent().parent().toggleClass(t.selectedClass);s();if($(t.acrossInput).val()==1){u()}});$(t.allToggle).show().click(function(){i($(this).prop("checked"));s()});$("span.actions span.question a").click(function(e){e.preventDefault();$(t.acrossInput).val(1);u()});$("span.actions span.clear a").click(function(e){e.preventDefault();$(t.allToggle).prop("checked",false);f();i(0);s()});lastChecked=null;$(n).click(function(e){if(!e){e=window.event}var r=e.target?e.target:e.srcElement;if(lastChecked&&$.data(lastChecked)!=$.data(r)&&e.shiftKey===true){var i=false;$(lastChecked).prop("checked",r.checked).parent().parent().toggleClass(t.selectedClass,r.checked);$(n).each(function(){if($.data(this)==$.data(lastChecked)||$.data(this)==$.data(r)){i=i?false:true}if(i){$(this).prop("checked",r.checked).parent().parent().toggleClass(t.selectedClass,r.checked)}})}$(r).parent().parent().toggleClass(t.selectedClass,r.checked);lastChecked=r;s()});$("form#changelist-form table#result_list tr").find("td:gt(0) :input").change(function(){r=true});$('form#changelist-form button[name="index"]').click(function(e){if(r){return confirm(gettext("You have unsaved changes on individual editable fields. If you run an action, your unsaved changes will be lost."))}});$('form#changelist-form input[name="_save"]').click(function(e){var t=false;$("div.actions select option:selected").each(function(){if($(this).val()){t=true}});if(t){if(r){return confirm(gettext("You have selected an action, but you haven't saved your changes to individual fields yet. Please click OK to save. You'll need to re-run the action."))}else{return confirm(gettext("You have selected an action, and you haven't made any changes on individual fields. You're probably looking for the Go button rather than the Save button."))}}})};$.fn.actions.defaults={actionContainer:"span.actions",counterContainer:"span.actions span.action-counter",allContainer:"span.actions span.all",acrossInput:"span.actions input.select-across",acrossQuestions:"span.actions span.question",acrossClears:"span.actions span.clear",allToggle:"#action-toggle",selectedClass:"selected"}})
